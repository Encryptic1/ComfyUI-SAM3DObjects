# ============================================================================
# Requirements for SAM3D Inference Worker Environment
# ============================================================================
# This file contains all packages for the isolated venv.
# PyTorch packages are installed separately with specific CUDA version.
# All other packages are installed via UV (10-100x faster than pip)
# ============================================================================

# NOTE: PyTorch packages are installed FIRST in a separate step:
# uv pip install torch==2.5.1 torchvision==0.20.1 --index-url https://download.pytorch.org/whl/cu121
# This ensures binary compatibility between torch and torchvision

# PyTorch ecosystem (install after torch/torchvision)
# pytorch3d - installed separately (see env_manager.py) due to lack of wheels
fvcore
iopath
torchsde

# Core scientific computing
numpy>=1.24.0,<2.0
scipy>=1.11.0

# Machine learning frameworks
timm>=0.9.16
transformers
diffusers
lightning>=2.0.0

# Image processing
opencv-python>=4.9.0
scikit-image>=0.23.1
imageio>=2.36.0

# 3D processing libraries
open3d>=0.18.0
trimesh
point-cloud-utils>=0.29.5
pyvista>=0.43.0

# Visualization
matplotlib>=3.9.0
seaborn>=0.13.0
plotly>=5.24.0

# Utilities
hydra-core>=1.3.2
easydict>=1.13
loguru>=0.7.2
huggingface-hub
python-igraph>=1.0.0
tqdm>=4.67.0
optree>=0.11.0
astor>=0.8.0

# Pip-only dependencies (not available via conda)
einops-exts>=0.0.4
roma>=1.5.1
xatlas>=0.0.9
pymeshfix>=0.16.0

# CUDA-specific packages (available on PyPI)
spconv-cu121>=2.3.8
# xformers - REMOVED: Optional, causes PyTorch version conflicts, SAM3D uses native PyTorch attention
# gsplat - installed separately via env_manager.py from prebuilt wheel to avoid JIT compilation
# kaolin - installed separately via env_manager.py with special find-links URL

# NOTE: CUDA development tools (nvidia-cuda-nvcc-cu12, nvidia-cuda-runtime-cu12) are NOT needed
# because we use pytorch3d as rendering_engine instead of nvdiffrast, avoiding CUDA compilation

# Additional utilities
gdown>=5.2.0
gradio>=4.44.0
zstandard>=0.22.0  # For decompressing conda packages (.tar.zst)
ninja>=1.10.0  # Required by gsplat wheels and for CUDA JIT compilation
jaxtyping  # Required by gsplat

# Git repository dependencies
git+https://github.com/microsoft/MoGe.git@a8c37341bc0325ca99b9d57981cc3bb2bd3e255b
# nvdiffrast - installed separately via env_manager.py from prebuilt wheel to avoid JIT compilation
